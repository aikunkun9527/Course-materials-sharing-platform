# 基于云计算的课程资料分享平台 - 架构设计文档

## 一、项目概述

### 1.1 项目背景
开发一个基于云计算的课程资料分享平台，允许学生注册、登录、上传和下载课程资料，并为每门课程提供讨论区功能。

### 1.2 核心功能
- 用户注册与登录
- 课程资料上传/下载
- 课程讨论区
- 用户权限管理

### 1.3 技术栈要求
- **PaaS平台**: 阿里云 Serverless应用引擎 (SAE)
- **关系型数据库**: 阿里云 PolarDB (MySQL)
- **文件存储**: 阿里云 对象存储 (OSS)

---

## 二、系统架构设计

### 2.1 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                         用户层                              │
│              (浏览器/移动端浏览器)                          │
└─────────────────────┬───────────────────────────────────────┘
                      │ HTTPS
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                   Web应用层 (PaaS)                          │
│              阿里云 Serverless应用引擎 (SAE)                 │
│  ┌────────────────────────────────────────────────────┐    │
│  │           后端应用 (Node.js/Python/Java)           │    │
│  │  - RESTful API 服务                                │    │
│  │  - 用户认证 (JWT)                                  │    │
│  │  - 业务逻辑处理                                    │    │
│  │  - 文件上传/下载控制                               │    │
│  └────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────────┐    │
│  │           前端应用 (React/Vue)                     │    │
│  │  - 用户界面                                        │    │
│  │  - 资料浏览/上传                                   │    │
│  │  - 讨论区交互                                      │    │
│  └────────────────────────────────────────────────────┘    │
└──────────────────┬────────────────────┬─────────────────────┘
                   │                    │
                   │                    │
                   ▼                    ▼
┌──────────────────────────────┐  ┌──────────────────────────┐
│     关系型数据库层           │  │      文件存储层          │
│   阿里云 PolarDB (MySQL)     │  │    阿里云 OSS            │
│  ┌────────────────────────┐ │  │  ┌────────────────────┐ │
│  │ - 用户表               │ │  │  │ - 课程资料文件     │ │
│  │ - 课程表               │ │  │  │ - 用户头像         │ │
│  │ - 资料表               │ │  │  │ - 其他多媒体资源   │ │
│  │ - 讨论表               │ │  │  └────────────────────┘ │
│  │ - 评论表               │ │  └──────────────────────────┘
│  └────────────────────────┘ │
└──────────────────────────────┘
```

### 2.2 三层架构说明

#### 2.2.1 表现层 (Presentation Layer)
- **技术**: React.js 或 Vue.js
- **职责**:
  - 用户界面展示
  - 用户交互处理
  - HTTP请求发送
  - 响应数据渲染

#### 2.2.2 应用层 (Application Layer)
- **技术**: Node.js (Express/Koa) 或 Python (Flask/Django)
- **部署**: 阿里云 SAE (Serverless应用引擎)
- **职责**:
  - 业务逻辑处理
  - 请求路由分发
  - 数据验证
  - 身份认证与授权
  - 调用数据库和文件存储服务

#### 2.2.3 数据层 (Data Layer)
- **关系型数据**: 阿里云 PolarDB for MySQL
  - 存储结构化数据（用户、课程、资料、讨论等）
- **文件存储**: 阿里云 OSS
  - 存储非结构化数据（PDF、PPT、视频、图片等）

---

## 三、技术选型方案

### 3.1 前端技术栈

| 技术 | 说明 | 版本建议 |
|------|------|---------|
| React/Vue | 前端框架 | React 18+ 或 Vue 3+ |
| Axios | HTTP客户端 | 1.6+ |
| React Router/Vue Router | 路由管理 | 最新版 |
| Ant Design/Element Plus | UI组件库 | 最新版 |
| Vite | 构建工具 | 5.0+ |

**推荐选择**: React 18 + Ant Design + Vite
- 生态成熟，组件丰富
- 开发效率高
- 社区活跃

### 3.2 后端技术栈

| 技术 | 说明 | 版本建议 |
|------|------|---------|
| Node.js/Python | 运行时环境 | Node.js 18+ 或 Python 3.10+ |
| Express/Flask | Web框架 | Express 4+ 或 Flask 3+ |
| JWT | 身份认证 | jsonwebtoken 9+ |
| MySQL Client | 数据库驱动 | mysql2 3+ 或 PyMySQL |
| Multer/FormData | 文件上传处理 | multer 1.4+ |
| OSS SDK | 阿里云OSS SDK | ali-oss 6+ |
| Axios | HTTP客户端 | 1.6+ |

**推荐选择**: Node.js 18 + Express + MySQL2
- JavaScript全栈，技术栈统一
- 异步性能优异
- 生态丰富

### 3.3 云服务选型

#### 3.3.1 应用部署 - 阿里云 SAE
- **优势**:
  - Serverless架构，自动扩缩容
  - 支持多种编程语言和框架
  - 免运维，开箱即用
  - 按量计费，成本可控

#### 3.3.2 关系型数据库 - 阿里云 PolarDB for MySQL
- **优势**:
  - 100%兼容MySQL
  - 性能优异，支持海量数据
  - 高可用（主备架构）
  - 自动备份

#### 3.3.3 文件存储 - 阿里云 OSS
- **优势**:
  - 海量存储，成本低
  - 高可靠（99.9999999999%）
  - 支持CDN加速
  - 提供临时URL授权访问

---

## 四、系统功能模块

### 4.1 用户模块
- 用户注册（邮箱/手机号）
- 用户登录（JWT认证）
- 密码加密存储（bcrypt）
- 个人信息管理
- 头像上传

### 4.2 课程模块
- 课程浏览/搜索
- 课程创建（管理员）
- 课程分类管理
- 课程成员管理

### 4.3 资料模块
- 资料上传（支持多种格式）
- 资料下载
- 资料预览（PDF、图片）
- 资料分类/标签
- 资料搜索
- 上传者信息展示

### 4.4 讨论模块
- 课程讨论区（每门课程独立）
- 发布讨论主题
- 评论/回复
- 点赞功能
- 富文本编辑器

### 4.5 权限模块
- 基于角色的访问控制（RBAC）
- 角色：学生、教师、管理员
- 资料访问权限控制

---

## 五、安全设计

### 5.1 身份认证
- 使用JWT (JSON Web Token)进行无状态认证
- Token过期时间设置
- RefreshToken机制

### 5.2 数据安全
- 密码使用bcrypt加密（salt rounds: 10）
- SQL注入防护（使用参数化查询）
- XSS防护（前端输入转义）
- CSRF防护（Token验证）

### 5.3 文件安全
- 文件类型白名单验证
- 文件大小限制
- 文件病毒扫描（可选）
- OSS签名URL过期时间控制

### 5.4 网络安全
- 强制HTTPS通信
- CORS配置
- 请求频率限制（Rate Limiting）
- API访问日志记录

---

## 六、性能优化

### 6.1 前端优化
- 代码分割 (Code Splitting)
- 懒加载 (Lazy Loading)
- 图片压缩与懒加载
- CDN加速（OSS自带）

### 6.2 后端优化
- 数据库连接池
- 查询优化与索引
- 响应缓存（Redis可选）
- 异步任务处理（大文件上传）

### 6.3 云服务优化
- SAE自动扩缩容配置
- OSS CDN加速配置
- PolarDB读写分离（可选）

---

## 七、开发与部署流程

### 7.1 开发环境
- 本地开发：Docker Compose搭建开发环境
- 本地数据库：MySQL 8.0
- 本地文件存储：模拟OSS（本地文件系统）

### 7.2 部署流程
1. **代码托管**: 阿里云Codeup / GitHub
2. **CI/CD**: 阿里云云效 / GitHub Actions
3. **应用部署**: SAE从镜像仓库拉取镜像
4. **数据库部署**: PolarDB创建实例和数据库
5. **OSS配置**: 创建Bucket，配置访问权限

### 7.3 部署步骤简述
```bash
# 1. 构建Docker镜像
docker build -t course-platform:latest .

# 2. 推送到镜像仓库
docker tag course-platform:latest registry.cn-hangzhou.aliyuncs.com/your-namespace/course-platform:latest
docker push registry.cn-hangzhou.aliyuncs.com/your-namespace/course-platform:latest

# 3. 在SAE控制台配置应用并部署
# - 选择镜像地址
# - 配置环境变量
# - 设置实例规格
# - 启动应用
```

---

## 八、项目目录结构

```
course-sharing-platform/
├── frontend/                 # 前端项目
│   ├── public/
│   ├── src/
│   │   ├── components/      # 通用组件
│   │   ├── pages/           # 页面组件
│   │   ├── services/        # API服务
│   │   ├── utils/           # 工具函数
│   │   ├── hooks/           # 自定义Hooks
│   │   ├── contexts/        # Context上下文
│   │   └── App.jsx
│   ├── package.json
│   └── vite.config.js
│
├── backend/                 # 后端项目
│   ├── src/
│   │   ├── controllers/     # 控制器层
│   │   ├── services/        # 业务逻辑层
│   │   ├── models/          # 数据模型
│   │   ├── middlewares/     # 中间件
│   │   ├── routes/          # 路由定义
│   │   ├── utils/           # 工具函数
│   │   ├── config/          # 配置文件
│   │   └── app.js           # 应用入口
│   ├── package.json
│   └── Dockerfile
│
├── docs/                    # 文档目录
│   ├── 01-架构设计.md
│   ├── 02-数据库设计.md
│   ├── 03-API设计.md
│   ├── 04-前端设计.md
│   └── 05-部署指南.md
│
├── scripts/                 # 脚本目录
│   ├── init-db.sql         # 数据库初始化脚本
│   └── deploy.sh           # 部署脚本
│
├── docker-compose.yml       # 本地开发环境
└── README.md                # 项目说明
```

---

## 九、下一步计划

1. **数据库设计** - 详细的表结构设计
2. **API设计** - RESTful接口规范
3. **前端设计** - 页面结构与交互流程
4. **云资源集成方案** - 具体的云服务配置
5. **部署文档** - 详细的部署步骤

---

## 十、项目里程碑

| 阶段 | 任务 | 预计工作量 |
|------|------|-----------|
| 第一阶段 | 数据库设计与创建 | 1天 |
| 第二阶段 | 后端API开发 | 3-4天 |
| 第三阶段 | 前端页面开发 | 3-4天 |
| 第四阶段 | 云资源集成与测试 | 1-2天 |
| 第五阶段 | 部署与优化 | 1-2天 |
| **总计** | | **9-13天** |

---

*文档版本: v1.0*
*创建日期: 2025-12-26*
